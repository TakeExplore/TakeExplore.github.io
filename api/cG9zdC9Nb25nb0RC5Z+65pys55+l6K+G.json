{"title":"MongoDB学习笔记","date":"2018-11-09T11:11:17.415Z","slug":"MongoDB基本知识","tags":["database"],"categories":["note"],"updated":"2018-11-09T11:17:37.079Z","content":"<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p>官网：<a href=\"https://www.mongodb.com/\" target=\"_blank\" rel=\"noopener\">https://www.mongodb.com/</a></p>\n<h2 id=\"基本概念和使用步骤\"><a href=\"#基本概念和使用步骤\" class=\"headerlink\" title=\"基本概念和使用步骤\"></a>基本概念和使用步骤</h2><h3 id=\"概念\"><a href=\"#概念\" class=\"headerlink\" title=\"概念\"></a>概念</h3><p>数据库（Database）<br>集合（Collection）:相当于关系型数据库的数据表<br>文档（Record）：相当于关系型数据库的记录</p>\n<p>和关系型数据库的不同：每个集合的文档里面的字段可以不同</p>\n<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><p>参考博客 ：<a href=\"https://www.cnblogs.com/ymwangel/p/5859453.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/ymwangel/p/5859453.html</a></p>\n<h2 id=\"mongo命令行\"><a href=\"#mongo命令行\" class=\"headerlink\" title=\"mongo命令行\"></a>mongo命令行</h2><h3 id=\"行数据库\"><a href=\"#行数据库\" class=\"headerlink\" title=\"行数据库**\"></a>行数据库**</h3><pre><code>$mongo\n</code></pre><p><strong>查看数据库（数据库中有表才会显示出来）</strong></p>\n<pre><code>show dbs \n</code></pre><p><strong>新建/进入数据库</strong></p>\n<pre><code>use 数据库名\n</code></pre><p><strong>系统参数</strong></p>\n<pre><code>db.stats()\n</code></pre><p><strong>删除数据库</strong></p>\n<pre><code>db.dropDatabase()\n</code></pre><h3 id=\"操作集合\"><a href=\"#操作集合\" class=\"headerlink\" title=\"操作集合\"></a>操作集合</h3><p><strong>新建集合</strong></p>\n<pre><code>db.createCollections(&quot;集合名&quot;)\n</code></pre><p><strong>查询集合</strong></p>\n<pre><code>show collections\n</code></pre><p><strong>修改数据库名</strong></p>\n<pre><code>db.集合名.renameCollection(&quot;新名字&quot;)\n</code></pre><p><strong>删除集合</strong></p>\n<pre><code>db.集合名.drop();\n</code></pre><h3 id=\"操作数据文档\"><a href=\"#操作数据文档\" class=\"headerlink\" title=\"操作数据文档\"></a>操作数据文档</h3><p><strong>插入记录</strong></p>\n<pre><code>db.集合表名.insert(\n    {\n        &quot;&quot;:&quot;&quot;,\n        &quot;&quot;:&quot;&quot;\n    }\n</code></pre><p><strong>查询记录</strong></p>\n<pre><code>db.集合名.find()\ndb.集合名.findOne()//抽出结果集中的第一条\n</code></pre><p><strong>支持js语法插入文档</strong></p>\n<pre><code>for(var i = 3;i &lt;= 10;i++){\n    db.集合名.insert(\n        &quot;&quot;:&quot;&quot;\n    );\n}\n</code></pre><p><strong>查询集合中文档数量</strong></p>\n<pre><code>db.集合名.count()\n</code></pre><p><strong>删除集合中的文档</strong></p>\n<pre><code>db.集合名.remove({})\n</code></pre><p><strong>排序 sort()</strong></p>\n<pre><code>db.集合名.find({},{}).sort({&quot;字段&quot;:&quot;1&quot;})//字段为1则升序排列，为-1则降序排列\n</code></pre><p><strong>抽出结果集中前n条</strong></p>\n<pre><code>db.集合名.find({},{}).limit(n);\n</code></pre><p><strong>跳过结果集前n条</strong></p>\n<pre><code>db.集合名.find({},{}).skip(n);\n</code></pre><p><strong>更新文档</strong><br>updata(参数一，参数二，参数三)<br>参数一：筛选数据的条件<br>参数二：更新的数据或者字段，若仅更新字段内容需{$set:{“”:””}} 否则更新整个文档内容<br>参数三：更新的范围，默认为第一条 若更新所有符合参数一的文档 参数三为multi:true</p>\n<pre><code>db.集合名.update({&quot;&quot;:&quot;&quot;},{$set{&quot;&quot;:&quot;&quot;}},{ : });\n</code></pre><p><strong>特殊更新</strong></p>\n<p>upsert:有则更新，无则追加</p>\n<pre><code>db.集合名.update({&quot;&quot;:&quot;&quot;},{$set{&quot;&quot;:&quot;&quot;}},{upsert:true});\n</code></pre><p>remove:条件删除数据</p>\n<h3 id=\"取出带条件的文档\"><a href=\"#取出带条件的文档\" class=\"headerlink\" title=\"取出带条件的文档\"></a>取出带条件的文档</h3><h4 id=\"简单条件\"><a href=\"#简单条件\" class=\"headerlink\" title=\"简单条件\"></a>简单条件</h4><p><strong>查询符合条件的文档</strong></p>\n<pre><code>db.集合名.find({&quot;&quot;:&quot;&quot;})\n{}中为检索条件\n\n\n$gte 大于等于\n\n$gt 大于\n\n$lte 小于等于\n\n$lt 小于\n\n$eq 等于\n\n$ne 不等于\n\n正则\n</code></pre><p><strong>查询文档并且分类输出</strong></p>\n<pre><code>db.集合名.distinct(&quot;键值&quot;)\n</code></pre><h4 id=\"复杂条件\"><a href=\"#复杂条件\" class=\"headerlink\" title=\"复杂条件\"></a>复杂条件</h4><p><strong>与或非</strong></p>\n<pre><code>db.集合名.find({$or:[{...},{...}]});\ndb.集合名.find({&quot;&quot;:{$in:[...]});\ndb.集合名.find({&quot;&quot;:{$exists:true}})\n</code></pre><h4 id=\"指定字段\"><a href=\"#指定字段\" class=\"headerlink\" title=\"指定字段\"></a>指定字段</h4><pre><code>db.集合名.find({},{字段一: true,字段二: 1})\n</code></pre><p>仅抽出字段一和字段二<br>默认抽出_id字段<br>若不需要（最好不要隐藏） 则加入</p>\n<pre><code>db.集合名.find({},{字段一: true,字段二: 1,_id:0})\n</code></pre><h2 id=\"特殊函数\"><a href=\"#特殊函数\" class=\"headerlink\" title=\"特殊函数\"></a>特殊函数</h2><pre><code>$inc：递加\n\n$mul：相乘\n\n$rename：改名\n\n$set：新增或者修改\n\n$unset：字段删除\n</code></pre><h2 id=\"使用索引\"><a href=\"#使用索引\" class=\"headerlink\" title=\"使用索引\"></a>使用索引</h2><p>getIndexes():查询索引（mongo有自带的一个id的索引）<br>createIndex({参数一},{参数二})：增加索引 若参数二为{unique:true} 则表明参数一字段不能重复<br>dropIndex({…})：删除索引</p>\n<h2 id=\"备份与恢复\"><a href=\"#备份与恢复\" class=\"headerlink\" title=\"备份与恢复\"></a>备份与恢复</h2><p>mongodump：备份<br>mongorestore：恢复</p>\n<p><strong>新建文件夹</strong></p>\n<pre><code>$mkdir 文件夹名\n</code></pre>","next":{"title":"leetcode刷题记录","slug":"leetcode刷题记录"},"link":"http://yoursite.com/post/MongoDB基本知识/","toc":[{"title":"安装","id":"安装","index":"1"},{"title":"基本概念和使用步骤","id":"基本概念和使用步骤","index":"2","children":[{"title":"概念","id":"概念","index":"2.1"},{"title":"使用","id":"使用","index":"2.2"}]},{"title":"mongo命令行","id":"mongo命令行","index":"3","children":[{"title":"行数据库**","id":"行数据库","index":"3.1"},{"title":"操作集合","id":"操作集合","index":"3.2"},{"title":"操作数据文档","id":"操作数据文档","index":"3.3"},{"title":"取出带条件的文档","id":"取出带条件的文档","index":"3.4","children":[{"title":"简单条件","id":"简单条件","index":"3.4.1"},{"title":"复杂条件","id":"复杂条件","index":"3.4.2"},{"title":"指定字段","id":"指定字段","index":"3.4.3"}]}]},{"title":"特殊函数","id":"特殊函数","index":"4"},{"title":"使用索引","id":"使用索引","index":"5"},{"title":"备份与恢复","id":"备份与恢复","index":"6"}],"copyright":{"custom":"飞过人间的无常 才懂爱才是宝藏"}}