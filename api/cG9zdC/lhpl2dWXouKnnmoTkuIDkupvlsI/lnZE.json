{"title":"写vue时踩的一些小坑","date":"2018-11-15T16:34:53.202Z","slug":"写vue踩的一些小坑","updated":"2018-11-18T10:04:01.888Z","content":"<h2 id=\"遍历后端传过来的json文件并且取出想要的值\"><a href=\"#遍历后端传过来的json文件并且取出想要的值\" class=\"headerlink\" title=\"遍历后端传过来的json文件并且取出想要的值\"></a>遍历后端传过来的json文件并且取出想要的值</h2><p>首先取到后端的值：</p>\n<pre><code>getList() {\n      return this.axios.get(&quot;../static/depTest.json&quot;)\n        .then(response =&gt; {\n          this.storeroom = response.data;\n          console.log(this.storeroom);\n        });\n    }\n</code></pre><p>遍历方法如下：</p>\n<pre><code>getAllJson(jsons) {\n      for (let a in jsons) {\n        let k = a;\n        if (!(jsons[a] instanceof Object)) {\n          if (a === &apos;name&apos;) {\n            this.arr.push(jsons[a]);\n            console.log(k + &quot; = &quot; + jsons[a]);//如果不是Object则打印键值\n          }\n        } else {\n          this.getAllJson(jsons[a]); //如果是Object则递归\n        }\n      }\n    }\n</code></pre><p>在created中先调用getList()方法取到值，后调用getAllJson()遍历数组，但是遍历函数的方法并没有起作用。</p>\n<pre><code>data() {\n    return {\n      storeroom: [],\n      arr: [],\n      list: [],\n    }\n  },\n  created() {\n    this.getList();\n    this.getAllJson();\n  },\n</code></pre><p>后知道原因为其是异步执行的，getList()和getAllJson()同时执行了，后台值还没有取完就开始执行下一个函数了。</p>\n<h4 id=\"解决方法有两个：\"><a href=\"#解决方法有两个：\" class=\"headerlink\" title=\"解决方法有两个：\"></a>解决方法有两个：</h4><p>一、使用es6的<br>async await<br>二、then</p>\n<p>在created中更改代码</p>\n<pre><code>this.getList().then(() =&gt; this.getAllJson(this.storeroom));\n</code></pre><p>就能顺利遍历json数组啦</p>\n<h2 id=\"循环显示json数据-并且根据点击显示相应的数据\"><a href=\"#循环显示json数据-并且根据点击显示相应的数据\" class=\"headerlink\" title=\"循环显示json数据 并且根据点击显示相应的数据\"></a>循环显示json数据 并且根据点击显示相应的数据</h2><h4 id=\"需求\"><a href=\"#需求\" class=\"headerlink\" title=\"需求\"></a>需求</h4><p>从后端获取json文件，左边显示json文件中的id字段，右边显示相应的内容，若没有的字段则不显示</p>\n<h4 id=\"实现思路\"><a href=\"#实现思路\" class=\"headerlink\" title=\"实现思路\"></a>实现思路</h4><ol>\n<li>先循环展示json</li>\n<li>为列表绑定一个点击事件，点击时调用方法selectType()，返回参数（id）</li>\n<li>为内容绑定方法needShow()，如果点击列表返回的参数和内容的id相同，则展示。</li>\n</ol>\n<h4 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h4><pre><code>&lt;template&gt;\n    &lt;el-row v-for=&quot;(content) in contents&quot;@click.native=&quot;selectType(content.id)&quot; class=&quot;list&quot;&gt;\n                {{content.id}}\n    &lt;/el-row&gt;\n    &lt;div v-for=&quot;content in contents&quot; v-show=&quot;needShow(content.id)&quot;&gt;\n        &lt;div&gt;\n            &lt;span v-show=&quot;content.name!==undefined&quot;&gt;类型：&lt;/span&gt;\n            {{content.name}}\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;span v-show=&quot;content.allTime!== undefined&quot;&gt;总时长：&lt;/span&gt;\n            {{content.allTime}}\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;span v-show=&quot;content.content!==undefined&quot;&gt;内容：&lt;/span&gt;\n            {{content.content}}&lt;/div&gt;\n        &lt;div&gt;\n            &lt;span v-show=&quot;content.time!==undefined&quot;&gt;时间：&lt;/span&gt;\n            {{content.time}}\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;span v-show=&quot;content.credit!==undefined&quot;&gt;信用：&lt;/span&gt;\n            {{content.credit}}\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;span v-show=&quot;content.price!==undefined&quot;&gt;价格：&lt;/span&gt;\n            {{content.price}}\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/template&gt;\n</code></pre><p> 数据：</p>\n<pre><code>data() {\n        return {\n          contents: [],//文章\n          essayId: 1,\n        }\n      }\n</code></pre><p>方法：</p>\n<pre><code>getArticle() {\n  return this.axios.get(&quot;../static/example.json&quot;)\n    .then(response =&gt; {\n      this.contents = response.data;\n      console.log(this.contents);\n    })\n},\nselectType(index) {\n  console.log(index);\n  return this.essayId = index;\n},\nneedShow(num) {\n  console.log(typeof(this.essayId));\n  let a = Number(num);\n  console.log(typeof(a));\n  if (a === this.essayId) {\n    console.log(a);\n    return true;\n  } else {\n    return false;\n  }\n},\n</code></pre>","next":{"title":"MongoDB学习笔记","slug":"MongoDB基本知识"},"link":"http://yoursite.com/post/写vue踩的一些小坑/","toc":[{"title":"遍历后端传过来的json文件并且取出想要的值","id":"遍历后端传过来的json文件并且取出想要的值","index":"1"},{"title":"循环显示json数据 并且根据点击显示相应的数据","id":"循环显示json数据-并且根据点击显示相应的数据","index":"2"}],"copyright":{"custom":"飞过人间的无常 才懂爱才是宝藏"}}